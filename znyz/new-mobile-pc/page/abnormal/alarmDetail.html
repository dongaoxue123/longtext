<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>详细</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="../../statics/plugins/layui/css/layui.css" media="all">

	</head>
	<script src="../../statics/plugins/layui/layui.js"></script>
	<!-- echarts-->
	<script src="../basedata/echarts/echarts.js"></script>

	<script src="../../js/common.js" type="text/javascript" charset="utf-8"></script>
	<style type="text/css">
		.info-title {
			font-size: 16px;
			font-weight: 600;
			margin: 12px 0;
		}
		
		.weight-val {
			font-size: 36px;
			font-weight: 800;
		}
		#pigInfo > .info-row {
			height:30px;
			line-height:30px;
			
		}
		.chart-btn {
			margin-top: 30px;
		}
		.mt30 {
			margin-top: 30px;
		}
	</style>

	<body>
		<div class='layui-container'>
			<div class='layui-row'>
					<section id='pigInfo'>
						<div class='info-title'>基本信息</div>
						<div class='info-row' ><span class="layui-col-xs6" style='line-height: 30px;' id="houseName"></span><span class="layui-col-xs6 " id="breeder"></span></div>
						<div class='info-row' ><span class="layui-col-xs6 info-row" id="pigVarietyName"></span><span class="layui-col-xs6 info-row" id="ageDay"></span></div>
						<div class='info-row' ><span class="layui-col-xs6 info-row" id="startTime"></span><span class="layui-col-xs6 info-row" id="endTime"></span></div>
					</section>
					<section id='alarmInfo'>
						<div class='info-title'>报警信息</div>
						<div class='info-row'><span class="layui-col-xs12" style='line-height: 30px;color:#ff0000'><span id='warn'></span></span></div>
						<div class='info-row'><img id='img' src="../../statics/img/warn.jpg" width='600'/>
						</div>
					</section>
					<section id='optInfo'>
						<div class='info-title'>处理信息</div>
						<div class='info-row'><span class="layui-col-xs6" style='line-height: 30px;color:#ff0000' id='clbj'>未处理</span><span class="layui-col-xs6" style='line-height: 30px;' id='clry'></span></div>
						<div class='info-row' id='clxx'><span class="layui-col-xs6" style='line-height: 30px;'></span><span class="layui-col-xs6" style='line-height: 30px;' id="suggestion"></span></div>
						</div>
					</section>
					
				<!--<div class="layui-col-xs4">
					<div class="info-title">当前均重</div>
					<div class='weight-val'>85.6KG</div>
					<div class='info-title'>当前状态：测重中</div>
					<table class="layui-hide" id="hogBatch" lay-filter="hogBatch"></table>
				</div>-->
			</div>

		</div>

		<!--code-->
		<script>
			
			/**
			 * 获取当前时间
			 */
			function getDate() {
				var myDate = new Date();
				//获取当前年
				var year = myDate.getFullYear();
				//获取当前月
				var month = myDate.getMonth() + 1;
				//获取当前日
				var date = myDate.getDate();
				var now = year + '-' + p(month) + "-" + p(date);
				return now;
			}

			function p(s) {
				return s < 10 ? '0' + s : s;
			}

			var farmId;
			var groupId;
			var fieldId;
			var authToken = localStorage.getItem("authToken");
			var user = localStorage.getItem("user");
			var type = GetQueryString("type");
			var breeder = getUrlParam("breeder");
			var alarmTime = getUrlParam("alarmTime");
			var handleTime = getUrlParam("handleTime");
			var handler = getUrlParam("handler");
			var suggestion = getUrlParam("suggestion");
			
			// handleTime
			// console.log(handler)
			document.getElementById('breeder').innerHTML=breeder
			document.getElementById('clry').innerHTML='处理人员：'+handler
			document.getElementById('suggestion').innerHTML='处理建议：'+suggestion
			var clbj = GetQueryString("clbj");
			setData()
			
			if(!checkToken()) {
				alert("登录超时，请重新登录！");
				window.top.location.href = '../../login.html';
			}
			farmId = JSON.parse(user).farmId;
//			groupId = JSON.parse(user).groupId;
			fieldId = GetQueryString("fieldId"); //'0000000000000000ac1adf71c07476f9'
//			var batchId = '0000000000000000a130b23569b8ac33'
console.log(00000000000000)
			layui.use(['form','laydate'], function(){
		        var form = layui.form;
		        var $ = layui.$;
		        var laydate = layui.laydate;
				if(!checkToken()){
		  			alert("登录超时，请重新登录！");
		 			window.top.location.href = '../../login.html';
				}
			
  			$.ajax({
				url: commonIP + 'api/pig/pigbatchfield/getListPage?authToken='+authToken+'&page=1&limit=10&fieldId='+fieldId+'&farmId=' + farmId,
				async: false,
				success: function(res) {
					var dataObj = JSON.parse(res);
					console.log(111111111111111)
					if(dataObj != null) {
						var datas = dataObj.dataSource.list;
						document.getElementById('houseName').innerHTML = '栋舍名称：'+ datas[0].houseName;
						document.getElementById('pigVarietyName').innerHTML = '品系：'+ datas[0].strainName + ' ' + datas[0].pigVarietyName;
						document.getElementById('ageDay').innerHTML = '日龄：'+ datas[0].growingDays;
						document.getElementById('startTime').innerHTML = '入栏：'+ datas[0].startTime;
						document.getElementById('endTime').innerHTML = '出栏：'+ datas[0].endTime;
					} 
				}
			});
            });
    

				
			function setData(){
				if(clbj==='1'){
					document.getElementById('clbj').innerHTML='已处理'
				}else{
					document.getElementById('clry').style.display='none'
					document.getElementById('clxx').style.display='none'
				}
				if(type==='1'){
					document.getElementById('warn').innerHTML=alarmTime+'人员异常'
					document.getElementById('img').src = '../../statics/img/warn/pig1.png'
				}else{
					document.getElementById('warn').innerHTML=alarmTime+'人员异常'
					document.getElementById('img').src = '../../statics/img/warn/person1.png'
				}
				try{
					switch(xh){
					case 1:
						break;
					case 2:
						break;
					case 3:
						break;
						
				}
				} catch{
					console.log(111)
				}
		
			}
		</script>
	</body>

</html>