<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>layui</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="../../statics/plugins/layui/css/layui.css" media="all">
  
</head>
<script src="../../statics/plugins/layui/layui.js"></script>
<script src="../../js/common.js" type="text/javascript" charset="utf-8"></script>
<body> 

<table class="layui-hide" id="interface" lay-filter="interface"></table>
<script type="text/html" id="barDemo">
	<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del" data-i18n="handle"></a>
</script>

<!-- 国际化        -->
	<script src="../../statics/plugins/i18n/i18next.min.js"></script>
	<script src="../../statics/plugins/i18n/i18nextXHRBackend.min.js"></script>
	<script src='../../statics/plugins/i18n/loc-i18next.min.js'></script>
<script>
	var authToken=localStorage.getItem("authToken");
	//alert(authToken);
	var user =localStorage.getItem("user");
	i18n('../../locales', onLangReady) //国际化
		function onLangReady() {
	if(!checkToken()){
  		alert(i18next.t("timeout"));
 			window.top.location.href = '../../login.html';
	}

	layui.use(['form','table','laydate'], function(){
		var table = layui.table;
		var form = layui.form;
		var laydate = layui.laydate;
		var $ = layui.$;
		  //方法级渲染
		table.render({
		    elem: '#interface'
		    ,url: language==="en"?"../../json/eninterface.json" :"../../json/interface.json" //commonIP + "api/system/interface/get?authToken="+authToken  //数据请求路径 
		    ,cellMinWidth: 80
		    ,cols: [[
		      {type:'numbers',width:'5%'}
		      ,{field:'className', title: i18next.t("interface.name") ,width:'25%'}
		      ,{field:'methodName', title:i18next.t("interface.type"),width:'20%'}
		      ,{field:'status', title:i18next.t("common.currentState"),width:'15%'}
		      ,{field:'createTime', title:i18next.t("common.createTime"),width:'25%'}
		      ,{field:'remark', title:i18next.t("common.remark") ,width:'10%'}
		    ]]
		    ,even: true //开启隔行背景
		    ,page: true   //开启分页
		    ,limit:10   //默认十条数据一页
		    ,limits:[10,20,30,50]  //数据分页条
		    ,id: 'testReload'
		});
		//监听工具条
			table.on('tool(interface)', function(obj){
				
			    var data = obj.data;
			    if(obj.event === 'detail'){
			      //layer.msg('ID：'+ data.id + ' 的查看操作');
  
			    } else if(obj.event === 'del'){
			        layer.confirm(i18next.t("interface.handleConfirm"), function(index){
			      		  $.ajax({  
					            url: commonIP + ""+authToken,
					            type: 'POST',
											contentType: 'application/json',
											data: JSON.stringify({"stageId":data.stageId}),
			                success: function(text) {
			                	var dataObj = JSON.parse(text);
			                		if(dataObj.code == 0){
					                		layer.msg(dataObj.msg, {icon: 6});
											        obj.del();
											        layer.close(index);  
			                		}else{
			                				layer.msg(dataObj.msg, {icon: 5});
			                		}
			                }
				            });  
			      		});
			    } 
		  });
		});
}
</script>

</body>
</html>