<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>layui</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="../../statics/plugins/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="../../statics/css/font-awesome.min.css"> <!-- 图标等 -->
</head>
<script src="../../statics/plugins/layui/layui.js"></script>
<script src="../../js/common.js" type="text/javascript" charset="utf-8"></script>
<body> 
	  <div>
    	<button class="layui-btn layui-btn-sm" data-type="add" id="add"><i class="layui-icon">&#xe608;</i> 添加</button>
    	<button class="layui-btn layui-btn-sm" data-type="reflesh" id="reflesh"><i class="fa fa-undo"></i> 刷新</button>
    </div>
<table class="layui-hide" id="farmdata" lay-filter="farmdata"></table>
<script type="text/html" id="barDemo">
  <!--<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
  <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>-->
  <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script>
	layui.use(['form','table','laydate'], function(){
			var table = layui.table;
			var form = layui.form;
			var laydate = layui.laydate;
			var $ = layui.$;
			  //方法级渲染
			table.render({
			    elem: '#farmdata'
			    ,url: commonIP + 'testdata/farm/getFarmList'  //数据请求路径
			    ,cellMinWidth: 80
			    ,cols: [[
			      {type:'numbers'}
			      ,{field:'farmId', title:'猪场ID',width:'6%'}
			      ,{field:'farmName', title:'猪场名称',width:'15%'}
			      ,{field:'code', title:'猪场编码',width:'7%'}
			      ,{field:'scale', title:'规模',width:'6%'}
			      ,{field:'address', title:'地址',width:'15%'}
			      ,{field:'createTime', title:'创建时间',width:'12%'}
			      ,{field:'remark', title:'备注',width:'20%'}
			      ,{fixed: 'right',title: '操作', width:'6%',  align:'center', toolbar: '#barDemo'}//一个工具栏  具体请查看layui官网
			    ]]
			    ,even: true //开启隔行背景
			    ,page: true   //开启分页
			    ,limit:10   //默认十条数据一页
			    ,limits:[10,20,30,50]  //数据分页条
			    ,id: 'farmReload'
			});
			 //监听工具条
			table.on('tool(farmdata)', function(obj){
			    var data = obj.data;
			    if(obj.event === 'detail'){
			      layer.msg('ID：'+ data.id + ' 的查看操作');
			    } else if(obj.event === 'del'){
			      	layer.confirm('确定删除此行数据吗', function(index){
			      		  $.ajax({  
					            url: commonIP + 'testdata/farm/delete?farmId='+data.farmId
			                ,success: function(text) {
			                		if(text.code == 0){
					                		layer.msg(text.msg, {icon: 6});
											        obj.del();
											        layer.close(index);  
			                		}else{
			                				layer.msg(text.msg, {icon: 5});
			                		}
			                }
				            });  
			      	});
			    } else if(obj.event === 'edit'){
			      layer.alert('编辑行：<br>'+ JSON.stringify(data))
				    }
		  });
			  
		  $('#add').on('click', function(){
		   		var index = layer.open({
					    type: 2,
					    content: './addFarm.html',
					    area: ['800px', '500px'],
					    maxmin: true
					});
//					layer.full(index);
		  });
		  $('#reflesh').on('click', function(){
		   		location.reload();
		  });
	});
</script>

</body>
</html>