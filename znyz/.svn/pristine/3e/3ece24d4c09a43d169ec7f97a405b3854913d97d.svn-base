<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>layui</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="../../statics/plugins/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="../../statics/css/font-awesome.min.css">
</head>
<script src="../../statics/plugins/layui/layui.js"></script>
<script src="../../js/common.js" type="text/javascript" charset="utf-8"></script>
<body> 
		<div>
    	<button class="layui-btn layui-btn-sm" data-type="add" id="add"><i class="layui-icon">&#xe608;</i> 添加</button>
    	<button class="layui-btn layui-btn-sm" data-type="reflesh" id="reflesh"><i class="fa fa-undo"></i> 刷新</button>
    </div>
<table class="layui-hide" id="piginfo" lay-filter="piginfo"></table>
<script type="text/html" id="barDemo">
  <!--<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
  <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>-->
  <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script>
	layui.use(['form','table','laydate'], function(){
			var table = layui.table;
			var form = layui.form;
			var laydate = layui.laydate;
			var $ = layui.$;
			  //方法级渲染
			table.render({
			    elem: '#piginfo'
			    ,url: commonIP + 'testdata/piginfo/getPigInfoList'  //数据请求路径
			    ,cellMinWidth: 80
			    ,cols: [[
			      {type:'numbers'}
			      ,{field:'pigId', title:'猪只ID',width:'6%'}
			      ,{field:'pigsNumber', title:'猪只编号',width:'6%'}
			      ,{field:'farmName', title:'所属猪场',width:'6%'}
		        ,{field:'pigVarietyId', title:'品种',width:'6%'}
	          ,{field:'strain', title:'品系',width:'6%'}
			      ,{field:'pigsType', title:'猪只类别',width:'6%'}
			      ,{field:'breedingSowType', title:'种母猪类别',width:'6%'}
			      ,{field:'earNum', title:'耳缺号',width:'6%'}
			      ,{field:'parity', title:'胎次',width:'6%'}
			      ,{field:'bornDate', title:'出生日期',width:'12%'}
			      ,{field:'enterDate', title:'入场日期',width:'12%'}
			      ,{field:'remark', title:'备注',width:'12%'}
			      ,{fixed: 'right',title: '操作', width:'6%',  align:'center', toolbar: '#barDemo'}//一个工具栏  具体请查看layui官网
			    ]]
			    ,even: true //开启隔行背景
			    ,page: true   //开启分页
			    ,limit:10   //默认十条数据一页
			    ,limits:[10,20,30,50]  //数据分页条
			    ,id: 'piginfoReload'
			});
			 //监听工具条
			table.on('tool(piginfo)', function(obj){
			    var data = obj.data;
			    if(obj.event === 'detail'){
			      layer.msg('ID：'+ data.id + ' 的查看操作');
			    } else if(obj.event === 'del'){
			        layer.confirm('确定删除此行数据吗', function(index){
			      		  $.ajax({  
					            url: commonIP + 'testdata/piginfo/delete?pigId='+data.pigId
			                ,success: function(text) {
			                		if(text.code == 0){
					                		layer.msg(text.msg, {icon: 6});
											        obj.del();
											        layer.close(index);  
			                		}else{
			                				layer.msg(text.msg, {icon: 5});
			                		}
			                }
				            });  
			      		});
			    } else if(obj.event === 'edit'){
			      	layer.alert('编辑行：<br>'+ JSON.stringify(data))
			    }
		  });
			  
		  $('#add').on('click', function(){
		   		var index = layer.open({
					    type: 2,
					    content: './addPigInfo.html',
					    area: ['700px', '600px'],
					    maxmin: true
					});
//					layer.full(index);
		  });
		  $('#reflesh').on('click', function(){
		   		location.reload();
		  });
	});
</script>

</body>
</html>