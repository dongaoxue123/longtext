
<html>
<head>
    <title>Title</title>
    <script src="../../statics/libs/jquery-1.7.2.js"></script>
    <link rel="stylesheet" href="../../statics/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../common/css/cyType.css">
    <link rel="stylesheet" href="../../statics/plugins/layui/css/layui.css" media="all">
    <script src="../../statics/plugins/layui/layui.js"></script>
    <script src="../../common/js/whole/cyLayer.js"></script>
    <script src="../../common/js/whole/utils.js"></script>
    <script src="../../js/common.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
<div class="layui-field-box">
    <form class="layui-form" action="">
        <div class="layui-form-item" style="padding-right: 20px">
            <label class="layui-form-label">猪场编码：</label>
            <div class="layui-input-block">
                <input type="text" name="code" lay-verify="code" placeholder="请输入编号" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item" style="padding-right: 20px">
            <label class="layui-form-label">猪场名称：</label>
            <div class="layui-input-block">
                <input type="text" name="farmName" lay-verify="required|farmName" placeholder="请输入名称" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item" style="padding-right: 20px">
            <label class="layui-form-label">规模：</label>
            <div class="layui-input-block">
                <input type="text" name="scale" lay-verify="scale" placeholder="请输入规模" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item" style="padding-right: 20px">
            <label class="layui-form-label">地址：</label>
            <div class="layui-input-block">
                <input type="text" name="address" lay-verify="address" placeholder="请输入地址" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">备注：</label>
            <div class="layui-input-block">
                <textarea placeholder="请输入内容" class="layui-textarea" lay-verify="remark" name="remark"></textarea>
            </div>
        </div>
        <div class="page-footer">
            <div class="btn-list">
                <div class="btnlist">
                    <button class="layui-btn" lay-submit="" lay-filter="submit"><i class="fa fa-floppy-o">&nbsp;</i>保存</button>
                    <button class="layui-btn" onclick="$t.closeWindow();"><i class="fa fa-undo">&nbsp;</i>返回</button>
                </div>
            </div>
        </div>
    </form>
</div>

<script>
    layui.use(['form','jquery'], function(){
        var form = layui.form;
        var $ = layui.$;
        //自定义验证规则  
		form.verify({  
	        code: function(value){  
	          if(value.length > 10){  
	            return '猪场编号不能超过10个字符！';  
	          }  
	        }, scale: function(value){  
	          if(value.length > 32){  
	            return '规模不能超过32个字符！';  
	          }  
	        }, address: function(value){  
	          if(value.length > 100){  
	            return '地址不能超过100个字符！';  
	          }  
	        }, remark: function(value){  
	          if(value.length > 200){  
	            return '备注不能超过200个字符！';  
	          }  
	        }    
		}); 
        //监听提交
        form.on('submit(submit)', function(res){
        	console.log(res.field);
       		$.ajax({  
	            url: commonIP + 'testdata/farm/create',
                data: res.field,
               	success: function(data) {
					var dataObj = JSON.parse(data);
					if (dataObj.errcode == "200") {
	                	console.log('ajaxSuccess! 请求成功');
		                $t.closeWindow();//关闭当前弹窗
	            		window.parent.location.reload();//刷新父页面
					}
                },
                error: function () {//请求失败处理函数
                	console.log('ajaxError! 请求失败');
	                $t.closeWindow();//关闭当前弹窗
//          		Msg.success("添加成功");
            		window.parent.location.reload();//刷新父页面
	            }
            });  
        });

    });
</script>
</body>
</html>
