<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>layui</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="../../statics/plugins/layui/css/layui.css" media="all">
  
</head>
<script src="../../statics/plugins/layui/layui.js"></script>
<script src="../../js/common.js" type="text/javascript" charset="utf-8"></script>
<body> 
    <div class="layui-form-item" id="button" style="margin-top: 10px;">
	    <label class="layui-form-label">创建时间:</label>
	    <div class="layui-input-inline">
	        <input class="layui-input" placeholder="请输入时间" id="createDate" name="createDate">
	    </div>
        <label class="layui-form-label">猪场名称:</label>
        <div class="layui-input-inline">
	    	 		<select id="farmId" name="farmId" style="height: 38px;border-color: #F0F0F0;">
			        	<option value="">请选择猪场</option>
			    	</select>
		    </div>
    	<button class="layui-btn" data-type="reload" id="search">查询</button>
    	<button class="layui-btn layui-btn-primary" data-type="reload" id="reset">重置</button>
    </div>
<table class="layui-hide" id="testdata" lay-filter="testdata"></table> 
<script>
	layui.use(['form','table','laydate'], function(){
		var table = layui.table;
		var form = layui.form;
		var laydate = layui.laydate;
		var $ = layui.$;
		  //方法级渲染
		table.render({
		    elem: '#testdata'
		    ,url: commonIP + 'testdata/data/getTestDataList'  //数据请求路径
		    ,cellMinWidth: 80
		    ,cols: [[
		      {type:'numbers'}
		      ,{field:'id', title:'数据ID',width:'5%'}
		      ,{field:'farmName', title:'猪场名称',width:'8%'}
		      ,{field:'serialNumber', title:'序号',width:'5%'}
		      ,{field:'frequency', title: '开机次数',width:'8%'}
		      ,{field:'bgPointer', title: '背景针',width:'8%'}
		      ,{field:'weight', title:'重量',width:'8%'}
		      ,{field:'createTime', title:'创建时间',width:'12%'}
		      ,{field:'fileName', title:'文件名称',width:'20%'}
		      ,{field:'fileUrl', title:'文件路径',width:'20%'}
//		      ,{fixed: 'right',title: '操作', width:'12%',  align:'center', toolbar: '#barDemo'}//一个工具栏  具体请查看layui官网
		    ]]
		    ,even: true //开启隔行背景
		    ,page: true   //开启分页
		    ,limit:10   //默认十条数据一页
		    ,limits:[10,20,30,50]  //数据分页条
		    ,id: 'testReload'
		});
		var active = {
		    reload: function(){
		      //执行重载
		      table.reload('testReload', {
		        page: {
		          curr: 1 //重新从第 1 页开始
		        }
		        ,where: {
		        		startDate:$("#createDate").val().substring(0,10),
		          	endDate:$("#createDate").val().substring(13,23),
	            	farmId: $("#farmId").val()
		        }
		      });
		    },
		};
		//获取猪场下拉
   	$.ajax({
        url: commonIP + 'testdata/farm/getFarmSelect',
        success: function (data) {
        	  if(data!=null && data.length>0){
	                var farmOption;
	                for (var i = 0; i < data.length; i++) {
		            			farmOption = farmOption+'<option value="'+data[i].farmId+'">'+data[i].farmName+'</option>';
	                }
	                $("#farmId").append(farmOption);
	                form.render('select');//一定要加form.render();
        	  }
        }
    });
    //创建时间 日期控件
    laydate.render({
		  	elem: '#createDate' //指定元素
		  	,range: true //是否开启范围选择，即双控件
		  	,theme: 'molv'
		  	,calendar: true //重要节日
//		  	,mark: {'2018-5-14': '生日','2018-5-28': '纪念日'} //日期备注，如重要事件或活动标记
		});
		$('#search').on('click', function(){
		    active['reload'].call(this);
		});
		$('#reset').on('click', function(){
			$('#createDate').val("");
			$("#farmId option:first").prop("selected", 'selected');  
		});
	});
</script>

</body>
</html>